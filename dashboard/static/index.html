<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <meta name="theme-color" content="#0b0f14" />
    <title>CapyFlix Monitoring</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <div class="title">
          <div class="titleRow">
            <h1>CapyFlix Monitoring</h1>
            <div class="clock clockInline" aria-label="Horloge">
              <div class="time" id="clockTime">--:--</div>
              <div id="clockDate">—</div>
            </div>
          </div>
          <div class="sub">
            <button id="servicesBtn" class="pill pillBtn" type="button" aria-label="Voir l'état des services">
              <span id="statusDot" class="dot"></span>
              <span id="statusText">Chargement…</span>
            </button>
            <button id="refreshBtn" class="pill pillBtn" type="button" aria-label="Changer la fréquence d'auto-refresh">
              <span>Auto-refresh</span>
              <strong id="refreshLabel">—</strong>
            </button>
            <div id="scanLine" class="pill scanPill" aria-label="Dernier scan Sonarr/Radarr">Scan: —</div>
          </div>
        </div>

        <div class="headerRight">
          <button id="weatherPill" class="pill pillBtn weatherPill" type="button" aria-label="Voir la météo détaillée">
            <span id="weatherIcon" class="weatherIcon">—</span>
            <strong id="weatherTemp">—</strong>
            <span id="weatherLabel" class="weatherLabel"></span>
          </button>
          <button id="reloadBtn" class="iconBtn" aria-label="Rafraîchir la page" type="button">
            <span class="icon">↻</span>
          </button>
          <button id="menuBtn" class="iconBtn" aria-label="Menu">
            <span class="icon">←</span>
          </button>
        </div>
      </header>

      <div class="grid">
        <section class="card sonarr">
          <h2>Prochains épisodes (Sonarr)</h2>
          <div id="sonarrList" class="list"></div>
        </section>

        <section class="card radarr-upcoming">
          <h2>Films bientôt téléchargés (Radarr)</h2>
          <div id="radarrUpcomingList" class="list"></div>
        </section>

        <section class="card qb">
          <h2>Téléchargements (qBittorrent)</h2>
          <div id="qbList" class="list"></div>
        </section>

        <section class="card jelly">
          <div class="cardTitleRow">
            <h2>Derniers ajouts (Jellyfin)</h2>
            <button id="addSeriesBtn" class="iconBtn addMediaBtn" aria-label="Ajouter un média" type="button">
              <span class="icon">＋</span>
            </button>
          </div>
          <div id="jellyList" class="media-grid"></div>
        </section>

        <section class="card system">
          <h2>Système</h2>
          <div id="systemStats" class="system-grid"></div>
        </section>

        <section class="card library">
          <h2>Ajouté aujourd’hui</h2>
          <div id="libraryToday" class="list"></div>
        </section>
      </div>
    </div>

    <div id="menuOverlay" class="overlay hidden" aria-hidden="true"></div>
    <aside id="menuPanel" class="panel hidden" aria-hidden="true">
      <div class="panelHeader">
        <div class="panelTitle">Accès rapide</div>
        <button id="menuCloseBtn" class="iconBtn" aria-label="Fermer">
          <span class="icon">✕</span>
        </button>
      </div>
      <div id="links" class="link-grid panelLinks"></div>
    </aside>

    <div id="servicesOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="servicesModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="État des services">
      <div class="modalHeader">
        <div class="modalTitle">État des services</div>
        <button id="servicesCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div id="servicesList" class="modalList"></div>
    </div>

    <div id="legendOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="legendModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Légende">
      <div class="modalHeader">
        <div class="modalTitle">Légende</div>
        <button id="legendCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div id="legendList" class="modalList"></div>
    </div>

    <div id="weatherOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="weatherModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Météo détaillée">
      <div class="modalHeader">
        <div id="weatherModalTitle" class="modalTitle">Météo</div>
        <button id="weatherCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div id="weatherContent" class="modalList"></div>
    </div>

    <div id="refreshOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="refreshModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Fréquence d'auto-refresh">
      <div class="modalHeader">
        <div class="modalTitle">Auto-refresh</div>
        <button id="refreshCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div id="refreshChoices" class="refreshChoices"></div>
    </div>

    <div id="addOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="addModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Ajouter un média">
      <div class="modalHeader">
        <div class="modalTitle">Ajouter (Jellyseerr)</div>
        <button id="addCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div class="addTypeRow" role="tablist" aria-label="Type de média">
        <button id="addTypeTv" class="typeBtn on" type="button" role="tab" aria-selected="true">Séries</button>
        <button id="addTypeMovie" class="typeBtn" type="button" role="tab" aria-selected="false">Films</button>
      </div>
      <div class="addRow">
        <input id="addQuery" class="textInput" type="search" placeholder="Rechercher une série…" autocomplete="off" />
        <button id="addSearchBtn" class="choiceBtn" type="button">Rechercher</button>
      </div>
      <div id="addHint" class="wxSmall">Tape au moins 2 caractères.</div>
      <div id="addResults" class="modalList"></div>
    </div>

    <div id="seasonOverlay" class="overlay modalOverlay hidden" aria-hidden="true"></div>
    <div id="seasonModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Choisir les saisons">
      <div class="modalHeader">
        <div id="seasonTitle" class="modalTitle">Choisir saisons</div>
        <button id="seasonCloseBtn" class="iconBtn" aria-label="Fermer" type="button">
          <span class="icon">✕</span>
        </button>
      </div>
      <div class="seasonActions">
        <div id="seasonHint" class="wxSmall">Choisis les saisons à demander.</div>
        <button id="seasonRequestBtn" class="seasonReqBtn" type="button">Demander</button>
      </div>
      <div id="seasonGrid" class="seasonGrid"></div>
    </div>

    <script src="/static/app.js"></script>
  </body>
</html>
